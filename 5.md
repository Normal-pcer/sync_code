[ B ] Mountain Booking 6s 512MB

Byte Mountain 是一个 ByteLand 的一个知名的美丽景区。Byte Mountain 上有 $n$ 个区域，标号依次为 $1$, $2$, $\dots$, $n$, 由 $n-1$ 条无名道路连接。每对不同的区域之间有且仅有一条路连接。换句话说，这座山的地图即为一棵带有 $n$ 个节点的树。

假设今天是第 $0$ 天。在接下来的 $m$ 天中，这座山的地图将会略微改变。具体地讲，在第 $i (1 \le i \le m)$ 天的清晨，第 $k$ 条路将会永久关闭，而另一条路会被建造；不过这个地图总会是一棵树。

你将会获得接下来 $m$ 天的道路建造计划，以及 $p$ 位旅客的订单。第 $i$ 位旅客将会在第 $a_i$ 天的下午游览第 $b_i$ 个区域，并在当晚离开山区。你现在想知道一些有趣的指标。

值得注意的是，每条路都有它的“权重”。令 $f(u, v)$ 表示在所有从 $u$ 到 $v$ ($u$ 不等于 $v$) 的唯一单个路径上，所有路径的权重的最大值。你将获得 $q$ 次查询。在第 $i$ 次查询中，你会获得两个整数 $c_i$ 和 $d_i$。你需要计算第 $d$ 个区域在第 $c$ 天的指定指标：

公式略